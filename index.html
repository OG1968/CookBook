<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/x-icon"
      href="https://upload.wikimedia.org/wikipedia/commons/4/4e/Cookbook_3.png"
    />
    <title>ספר מתכונים</title>
    <style>
      /* קוד CSS הקיים */
      :root {
        --primary-color: #4caf50;
        --background-color: #1a1a1a;
        --text-color: #ffffff;
        --input-bg: #333;
        --item-bg: #333;
        --progress-bg: #333;
        --container-bg: #2d2d2d;
        --input-bg-hover: #444;
        --primary-color-hover: #3e8e41; 
      }

      * {
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        transition: background-color 0.3s, color 0.3s;
      }

      body {
        background-color: var(--background-color);
        color: var(--text-color);
        margin: 0;
        padding: 0 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        margin-bottom: 0;
        position: sticky;
        top: 0;
        background-color: var(--background-color);
        z-index: 1000;
        padding: 5px;
      }

      h1 {
        font-family: "Secular One", sans-serif;
        color: #ffffff;
        text-shadow: 0 0 5px #0004d4, 0 0 10px #0004d4, 0 0 20px #0004d4,
          0 0 40px #0004d4, 0 0 80px #0004d4;
        font-size: 28px;
        font-weight: 400;
        line-height: 0.5;
        text-align: center;
      }

      .theme-toggle {
  position: absolute;
  top: 10px;
  left: 5px;
  padding: 5px;
  border-radius: 35%;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  background-color: var(--primary-color);
  border: none;
  color: white;
  z-index: 1001;
  transition: background-color 0.3s ease, transform 0.5s ease;
}

.theme-toggle:hover {
  animation: rotate 0.5s ease;
}

@keyframes rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

#helpButton {
  position: absolute;
  top: 10px;
  left: 40px;
  padding: 5px;
  border-radius: 35%;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  background-color: var(--primary-color);
  border: none;
  color: white;
  z-index: 1001;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

#helpButton:active {
  background-color: #ff4444;
  transition: background-color 0.5s ease;}

@keyframes blink {
  0% {
    background-color: var(--primary-color);
  }
  50% {
    background-color: #ff4444; /* צבע אדום */
  }
  100% {
    background-color: var(--primary-color);
  }
}

      .input-group {
        margin-bottom: 0px;
      }

      .input-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        text-align: right;
        font-size: 16px;
        width: 100%;
      }

      .input-group input,
      .input-group textarea {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
        background: var(--input-bg);
        color: var(--text-color);
        border: 2px solid var(--primary-color);
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
        border-radius: 5px;
        resize: vertical;
      }

      .input-group input:focus,
.input-group textarea:focus {
  border-color: #4caf50;
  box-shadow: 0 0 5px rgba(76, 175, 80, 0.5); /* צל קל סביב השדה */
}
      /* הגבלת גובה שדה הכותרת לשתי שורות */
      #title {
        min-height: 2.5em;
        max-height: 4em;
        overflow-y: auto;
        white-space: pre-wrap;
        resize: none;
      }

      .recipe {
  border: 1px solid var(--primary-color);
  padding: 10px;
  margin-top: 10px;
  position: relative;
  background: var(--item-bg);
  border-radius: 5px;
  width: 100%; 
  max-width: 800px; 
  margin-left: auto;
  margin-right: auto;
}

.recipe .delete-btn,
.recipe .share-btn,
.recipe .edit-btn {
  width: 30px;
  height: 30px;
  position: absolute;
  left: 5px;
  cursor: pointer;
  border: none;
  border-radius: 50%;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 5px;
  transition: transform 0.2s ease; 
}

.delete-btn:active,
.share-btn:active,
.edit-btn:active {
  transform: scale(0.9); 
}

.recipe .delete-btn {
  background: #ff4444;
  top: 5px;
}

.recipe .edit-btn {
  background: #4caf50;
  top: 75px;
}

      .recipe h3 {
        text-align: center;
        margin: 0 auto;
        display: block;
        width: 100%;
      }

      .recipe p {
        text-align: right;
      }

      .recipe p span {
        white-space: pre-line;
      }

      .editable {
        display: inline-block;
        min-width: 50px;
        cursor: text;
      }

      .delete-btn,
      .share-btn,
      .edit-btn {
        width: 30px;
        height: 30px;
        position: absolute;
        left: 5px;
        cursor: pointer;
        border: none;
        border-radius: 50%;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
      }

      .delete-btn {
        background: #ff4444;
        top: 5px;
      }

      .delete-btn:hover {
        background: #0088ff;
      }

      .edit-btn {
        background: #4caf50;
        top: 75px;
      }

      .edit-btn:hover {
        background: #daf81c;
      }

      [data-theme="light"] {
        --background-color: #ffdfa8;
        --text-color: #000;
        --input-bg: #ffffff;
        --item-bg: #ffffff;
        --progress-bg: #ddd;
        --container-bg: #dcdcdc;
      }

      [data-theme="light"] .input-group input,
      [data-theme="light"] .input-group textarea {
        border-color: #555;
      }

      #search-results .recipe {
        border: 1px solid var(--primary-color);
        padding: 10px;
        margin-top: 10px;
        background: var(--item-bg);
        border-radius: 5px;
        width: 100%;
        cursor: pointer;
      }

      .buttons-container {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
        padding: 0;
        flex-direction: column;
      }

      .uniform-btn {
        padding: 2px;
        font-size: 16px;
        background-color: #74a5ff;
        color: rgb(0, 0, 0);
        border: none;
        border-radius: 10px;
        cursor: pointer;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 40px;
        width: 100%;
        margin-bottom: 4px;
        font-weight: bold;
        font-size: 14px;
        transition: background-color 0.3s ease, transform 0.2s ease;
      }

      .uniform-btn:hover {
        background-color: #5a8de6;
        transform: scale(1.05); 
      }

      .custom-file-input {
        display: inline-block;
        padding: 10px;
        font-size: 14px;
        background-color: #74a5ff;
        color: black;
        font-weight: bold;
        border-radius: 10px;
        cursor: pointer;
        text-align: center;
        margin: 0;
        width: 100%;
      }

      .custom-file-input input[type="file"] {
        display: none;
      }

      @keyframes slideInFromRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

      .scroll-to-top-btn {
        position: fixed;
        bottom: 20px;
        left: 20px;
        padding: 5px;
        border-radius: 35%;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: #74a5ff;
        border: none;
        color: white;
        z-index: 1001;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        animation: slideInFromRight 0.5s ease-out;
      }

      .scroll-to-top-btn:hover {
        background-color: #5a8de6;
        transform: scale(1.1);
      }
      
      /* עיצוב תפריט הבחירה */
#category {
    width: 100%;
    padding: 8px;
    box-sizing: border-box;
    background-color: var(--input-bg); 
    color: var(--text-color); 
    border: 2px solid var(--primary-color); 
    border-radius: 10px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s, color 0.3s, border-color 0.3s;
}

/* עיצוב תפריט הבחירה במצב hover */
#category:hover {
    background-color: var(--input-bg-hover); 
    border-color: var(--primary-color-hover); 

}

/* עיצוב תפריט הבחירה במצב focus */
#category:focus {
    outline: none; 
    border-color: var(--primary-color); 
    box-shadow: 0 0 5px var(--primary-color); 
}

/* עיצוב תפריט הבחירה במצב תצוגה כהה */
[data-theme="dark"] #category {
    background-color: var(--input-bg); 
    color: var(--text-color); 
    border-color: var(--primary-color); 
}

/* עיצוב תפריט הבחירה במצב תצוגה בהיר */
[data-theme="light"] #category {
    background-color: var(--input-bg); 
    color: var(--text-color); 
    border-color: var(--primary-color); 
}

      .add-recipe-btn-container {
        text-align: center;
        margin-bottom: 20px;
      }

      .add-recipe-btn-container button {
        padding: 10px;
        font-size: 16px;
        background-color: #74a5ff;
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        width: 100%;
        max-width: 200px;
        margin: 0 auto;
        display: block;
      }

      .buttons-row {
        display: flex;
        gap: 4px;
        margin-bottom: 10px;
        margin-top: 10px;
      }

      .add-image-btn {
        display: block !important;
        visibility: visible !important;
      }

      .delete-all-btn {
        background-color: #ff4444 !important; 
        color: rgb(0, 0, 0) !important; 
      }

      .delete-all-btn:hover {
        background-color: #cc0000 !important; 
      }

      .category-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 10px;
}

.category-btn {
  flex: 1;
  margin: 0 2.5px;
  font-size: 14px;
  padding: 2px;
  background-color: #74a5ff;
  color: rgb(0, 0, 0);
  border: none;
  border-radius: 10px;
  cursor: pointer;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 40px;
  font-weight: bold;
  transition: background-color 0.3s;
}

#toggle-edit-btn {
  transition: background-color 0.3s ease, transform 0.2s ease;
}

#toggle-edit-btn:active {
  transform: scale(0.95); /* הקטנה קלה של הכפתור */
}

.category-btn:hover {
  background-color: #5a8de6;
}

      @media (max-width: 600px) {
        .input-group {
          flex-direction: column;
        }

        h1 {
          font-size: 22px;
        }

        .recipe {
          padding: 5px;
        }
      }

      /* סטייל למודל המותאם אישית */
      .modal {
        display: none;
        position: fixed;
        z-index: 1002;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
      }

      .modal-content {
        background-color: var(--container-bg);
        margin: 15% auto;
        padding: 20px;
        border: 1px solid var(--primary-color);
        width: 80%;
        max-width: 500px;
        text-align: right;
        color: var(--text);
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .close {
        color: var(--text);
        float: left;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }

      .close:hover {
        color: var(--button-hover);
      }

      .input-group[data-search="true"] {
        display: block !important;
      }

      .input-group-row {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 10px;
  gap: 4px; 
}

.input-group-row textarea,
.input-group-row select,
.input-group-row input {
  width: 100%; /* רוחב מלא של השדה */
  height: 40px; /* גובה אחיד לשדות */
  padding: 8px; /* ריפוד פנימי */
  box-sizing: border-box; /* כולל ריפוד וגבול ברוחב */
  border: 2px solid var(--primary-color); /* גבול בצבע ראשי */
  border-radius: 5px; /* עיגול פינות כמו בשדה הכותרת */
  background-color: var(--input-bg); /* צבע רקע */
  color: var(--text-color); /* צבע טקסט */
  font-size: 16px; /* גודל טקסט */
}

#title {
  overflow: hidden; /* הסתרת חיצי הגלילה */
  resize: none; /* מניעת שינוי גודל ידני */
}

.input-group-row textarea {
  resize: vertical; /* אפשר שינוי גובה אנכי בלבד */
  min-height: 40px; /* גובה מינימלי */
}

.input-group-row .input-group {
  flex: 1; /* כל שדה יקבל את אותו הרוחב */
  margin-right: 4px; /* רווח של 4 פיקסלים בין השדות */
}

.input-group-row .input-group:last-child {
  margin-right: 0;
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.toast {
  animation: slideIn 0.5s ease-out, fadeOut 0.5s ease-out 2.5s;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(40px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#search-results {
  animation: slideDown 0.5s ease-out;
}

.recipe .share-btn {
  width: 30px;
  height: 30px;
  position: absolute;
  left: 5px;
  cursor: pointer;
  border: none;
  border-radius: 50%;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 5px;
  transition: transform 0.2s ease;
  background: #ffc61b; 
  top: 40px; 
}

.share-btn:hover {
  background: #a371ff; 
}

.share-btn:active {
  transform: scale(0.9); 
}

.share-btn {
  background: #ffc61b;
  top: 110px; 
}

    </style>
    <script>
      const defaultImage =
        "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAcHBwcIBwgJCQgMDAsMDBEQDg4QERoSFBIUEhonGB0YGB0YJyMqIiAiKiM+MSsrMT5IPDk8SFdOTldtaG2Pj8ABBwcHBwgHCAkJCAwMCwwMERAODhARGhIUEhQSGicYHRgYHRgnIyoiICIqIz4xKysxPkg8OTxIV05OV21obY+PwP/CABEIAQABAAMBIgACEQEDEQH/xAAcAAABBQEBAQAAAAAAAAAAAAADAgQFBgcBAAj/2gAIAQEAAAAAYEIRSzqUpauqX73fc8niUoHxI/CanWUhFlUTvVy1mHWWPOc94aUoShKEMTHKshFkU/tRbN6u0rQgVOJ7xCRpShI0sDmKsxV9caob3Y3Ommo5pVbm3UlCBoSgYmhjGWYquzWisWL6sUu0lz5zdofvEJENCBhaOTlIYnSG0Ku16chGUu2hXk218jiAjSgImrg5SlItfD8fzB6lUGchYjjdIQgY0IEFsc5irKgplrvYwwdTzrONb0uSyO4zcA+SNIRNjlMVbPFtTkWbnUTBiatjZ5kGjs5Sbq0uJCAiaODGISCxPW5shraOGiojIrVIsbDLvGufbQEYxhZuDHIWt4nq8u7bss5gG5Htwl40UZpUVif1TwQxBaHcGIur4pq1jbx0RKtGgK2i5ir5dCisQ+sxjEILY5TlJT8Y0yzsqgqyI60ikSTeFNdWGJfXggiEFqYrgy6Ljum2RF29nzblrsHMrZwzjQozB/r8IhCC2McxSZ9j2kWa7QuB7lXX+gfN81ca9Bmu7DE/sIQQjbgMcxSZvjujWr2U5X9FyVnx/MgbwCFVeojGfshABDC2Icxi5hj2j2iZ+apDUnj+n5ZfXsnCt7DE1H6nchGILYxTlLluN6NYZuYq1Xiz6eOsRTuqVqveu+x30YRCZHMcpMlyDRZtzMQo5GMC89E7d82U+K9fNsuCAhE0MYxS5BkN+nPIR5PErNXb3Ts5YJvO03gYghaFOYxcayDQZlPEob9cqasq0wRF+tOz6MIYQsjmKYmM5DfZRPkGN1u14hvU1aFXtBvNiCIImLghjLxXJbxJ8R7o1pHwfIvt8rsbabnd/BEzOUplYlk13kEoWML1sPyRtvaTFZF9W1N3cfBbGKQhMPyW7vhvQ+bvBibDG0carCYr9pw9PmbAIJCFIvDMjusgCYAadr0s2iYvgVaxFYb9qhpLi0BSoqyKwTKrifs3GvTNPLHDKaG1eJwr7fDGPkDWpal9wPRMIeL6d75wyi0jS6l7rGZT9f8AkIQgy196rDdW+SbOrniKUMXEEtM+/r+e/Uy0cSl8rvvKqdM+f7FIuOi6NfgT87c6Hlcdp+zc6rvn6ldWETZkdqwYs2EbGxkZLXP1KRYbk8IRRfWAnSK6pXe+V7vle93jFpwxll97ief/xAAaAQABBQEAAAAAAAAAAAAAAAACAQMEBQYA/9oACAECEAAAAGUU1cNeFrgRENVJ5OjK5KYbFBNTcdhQ4D7mlig0HETjpwWFhSau7CYAEZ5l0rEYrNRf0+wASIsq5zivwY2uB4APnMgspYkxqDtVRtOIseOvj5rZV2Y3RMCi8uSjaaPXXcCsv7wYndyZKK+wq9D02imVolyZWA33GVnZXL0QSVclWo+jrB7JyyjRz4slVOSeJhNe666y6q5aqamCAO6zppKCDVVUNeHq/US9MfZvkdNUAWImukqI/wD/xAAbAQACAwEBAQAAAAAAAAAAAAACAwEEBQYAB//aAAgBAxAAAADZmFglAG1pkcyMAlNANAZqaDTIhFSaz7ugk+L1WuYYLUhV0D1alOIk2rFXc1FczZ0NiOI1ctp+Bf0CnEOr2rfzK+gzGA+hoz/aWRb1/lz/ADJ8MfRUcDd6nhtXt/lbWs9MR9C9yVrQxNHYw8bNueIffQyWSz9h7GDx98/DP0J4n4CpUK3LERD76HaBcjYLgzPICfe+g36VOF69j58qtt4DRnr9wKQsvF89igwWxF7r7fpOMrlLPOMLYgYiCY86+RVW1n//xAAiEAACAgMBAAIDAQEAAAAAAAABAgQFAAMGEgcREBMUFiD/2gAIAQEAAQIAKqgTwEXWqBAgQa/AQa/1+PAQp4KePBTwyFChTwUZPKqqqgQIqhQgTz5CQKjVykjl5dZ48eQvgqV8lfooVKFSoVVVVUKFCKgXzBrdXJ6+WVXaynx7bXRyYsuL5+ihUqQVK+GUqVVQEUKAqhQv1F0RYzsjM0qRfzOEhTJN/cVe/bqA8lSpVkKlSpDAKqqiqEVVX6Kc6hMnfAnb90+VM18klpNm6KmHuXx5KlCjKylSrKyoiqqhQiqFC+YW95M6X+17LfvOyI0jNzVwkv4KFCpVkKFSjKyqqqqqiqFChPJTVIG2HQ1tHogT6W9rZOxKrXqWS00qVIKkFCpDK6BVRQoAACtJTYE/n0/jXmrProdPdTdEvhr2B29tXw7GknNWap5QqylWV1CqqqqhQtdK62ZT2TVv+YPLRM9qyLKfu3pK2XKeFxlpIgV/OmPes6FSpVg6qFUKgChNWdAaHJ8+vcyKuz39fI+QNnyLK7TsNtNvsYuibQybLfAkWtjW227CrAqyuqqAoVQArZfmixIGx2O/TZ8s/PmoSo10kCMolwpjQIsPLoVEhUZSCrB8VFVVAC/Trf5Rvsd2L2M0M8b+DfGmWVV0n2+WLwzDe4elwqysCGV1CqFChVC7svjSB82HdyG3gNUZ1QzYOrldvLOXebrhiLKnvTYUKsGBD4AoVVCjJIvcon2mJDjcjN5TYjlWp+XjQbXlpGtxPSJkJr1qIEMCGDKw8qEUAL5mm6NIjmvzqa7lPkXpXcU1e7/LGn4z77pX25PMVhps3oiQwZSGDKAoQAKAtjl01MRnyP0PV/IpyPIfOPyk+Sriwqj1ErfkvZGOuNaZQkqwYFWDqFAQKFAy1y3ylZdnR0MiNS0V67ijn/IPGvnJcx0Eg6J1eNq9NYX9JQRrFgwIYMBihQoUAW2WpqnL01nazZN5OpN17z9RT9BKk2nQ1tc9dv1zNO/NC08Xk4DBlYMGCqoUKFAF01plSCYxG6Ru1OJ+512pLkJo3TrDqh+6SNGUec3hDBgwYKFxAuLgF6LPKs+lcu20O25dh2ay++Wa296q61a9+aRSty7sCCGD4MUKFxQM6A2Rq3+wWwM6s6nXq27vcnRJTVG3Zs16tEBuM0sGDBgwUKBi4uDOhyyyBnr2X9JtGF9m0szBpMefS6ICRkMmHT9E6sGxsIXFAC4v46JrI1rYcB+y52q5Zm+yS0t0XXGuoVF1aCqt9EhgwbFChQoXBnSmzyBn27K6BMd5MNkOtiWLb0i5GgXEbmnteYWNEk6t7YwUDFC4MGdObEwWJd4UAyHfbq2yZGPM3v8AiSIB1C4FDjm1q4xrN7Y2KoChQAB1ZnGvLNsNcnUv1YeDzyWqUVdPnkguIQ0C1ynZ1Yz9DwmDAIFChQv11jT8gYkhjUSbV5M7Rexd33VPbphbea91aa9YzYy7orIwZfAQIFCheiWTxdZudUYiCkt0VNz7PRZ936osKFzwjWK0cFHJJJJOeQoH19fUvT2UunkLtGz9o2jeN5kvswZtjHZx0BhHHU7KIRth2HZ+wv7wH17Gz3U8x8q2v1GuEf8AWdP6W0roaMsZkgUMbhwOouN3U6n42naf/cJol/1f1B/YYH7d31Gm/wAL/itvx8/xa/xNs+JtnxRt+LtnA7ub3Qee6DX1+7oZkbTzcCh07VQaxpGgaDGCBQoULn0PyPx9/wDTJsp25gcytCtUIAhmL/L/ADGN/P8A/8QARBAAAgEDAgMFAwgHBgYDAAAAAQIDAAQRBSESMVEGEyBBcRQiYRAwUnJzgbGyFTJDYnSRoSMkM0JjgxYlJoKSs0XR4v/aAAgBAQADPwD329T898PmMeLNb/IQayx8YrNDwXd5vGmEzu7bCoQo725Zj+6AtW+CY7plP7wDVcWpJYB1+ku4o0R8mfm817x9fFnwXN85WJNhzY7AVCFHe3LE/ugCrZJkYzM6A5KkUqKFUAKBgAbAAVwihEpOaku75LZGyZXCgVpkQ3g4j1Yk1pKqQ1tHj4ZWrNmJtZQG+gx/A0QSrAgg4IPzmGPyDxvc3EUK83YD06morWFIo1wqisCgwJoKKCqd6JRlU7mjNrEty+4gjJH1noRq29OoZVO9Tz3Iyx3NO0QlPMEAnqPKj837x9fmV/SkeeYViKxQUHeka4khY7sMrQAO9ZBANGViTSWtrdtjDPJ+AokEKaeVyxzXBODSiykXHTH8x8o+YzW5+Y2o2l1DOBngO46g7GkKB1YFWGQR5g0TkLUqTLKpwynINLPGDnhbG4qEn3pkHqwq2blNGf8AuFBIcIwKnzFZyTSAkUC4IFZAQeW5+cwxz1+aniTgVsr5A+VSOQohdpGOAqgHJq7unl9slNuEYARRYJIIByWIrToBcA26ysspAaQd42MAgZarQi9iMEeBPkDA5FVqxk17TYTAnAyzMy42OENRaUks1tmNhy4CVJNatZXoszfF8HhJkAbcczWtzyHKx93sVlBwGBHTJIq202Me1XkSufpMFH3Zq1k3STj+Kgt+AqzDhGnVGPJX90n/AMseMeD3j47WP9e4iX1YCopFDRSBwRkFTxZqU8oJT/ttVzz9ncepVfxIqaCeGXgUBXBOXXkOfLNYmB+kn5TWLm5XqEb+eRWLq9Hwj/qCK4u0g/csZT97Mor2nUtJtfKW8iz6Bgxp4pLuWJyrEtgg4IJNPJbx+03t1Io90KZHKjooGasNAgvraWKS2IlV2JXJNaFfyiKDVIzIeSnK1a6vaPbXa8Ske63+ZD5FTWraLDqtrOVnGnThHLZHDHJ+o4qPVrGG5a+ijd85jEJbGCRzLCpmQm3vYGfyWSMqD94Y0DeSWFzGYLpBkoTkMOqnx+8fERNfGVFfgkIUMMgAeQp57+Q5AFXsWiaRa2xkaea1HdqCAAEXmTXaWcQGTUrdA0ZMwGSQ3kFNak6Qd7rrK4fMgjXIKdFydjVtILrj1K6y5XusEZiA/MaxZ2WGZwqqCzYycDhycYGSaQXRYEHMeGxvuDWLm5fu3wyRge6dypanGq3Ny0MoX2XgU8B3JINKe0NjNIDHHBHcOWkBUA92VHOgIQQwYPIBUUVrAWQAhASceZo24hVbUSIx4S2QCCxwAoxg58t6tZ41lCDhcZBIHx2PxU1JcRSWE8haWAAxsebR1Z3PbbVbS6BNvd6IDL/tSVoNpAE0+SaAOsTAluP9ZjkkGnggE4lDKA7nywoOw+JxUE+odnbxTubtbWTqUlohiDzBwfF7x8XDJqGCd5DRN49TqNEKAdz+j2DHYYJCkCnizFCFeZhk5OyrnHE3w6CpEslaWUyNIzOpYBTwchsByNYOxqwTTYzcXMaFGYEMQCCDWjRZCyF/QVpcfQfWcCtIOxnhH+6taRcKQNQjTP79WcqRvDeRTFpckKckDBoNbREgZwKF1ZyxA8LMNm6EcjU26osYZmLSQsCpWQ88EHZSeW1G11/TJNws7YJO2VcVG/bycRSo4fRpogQQRxbtTd3a5HOC0/FqnjtoFDnhMc4YehwKmuRpMbuTjULY/eHrM0x/1G/HxbnxEPf89pG8gaJu5D8ajLaMTLhv0e4VByI9zLUxkuZLjZZZ+IrzLhQFUMfJQBy8yaLHJokEYFJPG0bANkEfEZ6EU3eExTyMvRiTVymc1MMbGnJG1KWBZaEMYUYwPLO1clqKWWORk95cFWGxGPxAplFhbRSgiMhHdhgMuMsMdGGQBVqvbSNIoAsXdlgo3AINEwWR629p/UtWbZj0iuP6NVy2qWtus5RWulAI5r72xFEKoZi7Y3Y82PU48WCfFma+GD/iMDX96enCaQOEEfo8kscZXPDsKOKJFXty0gsoO8CEhpmcRRKfMFm5nqBmtV0mA3d7BbS2gIEktrOJSmdgSCFqOeFZFIZWVSrDcMGGQahI8jUZ3Ax58qSHBMkSKQcvK3CigcyxGT6AAmrKInue0Fu8nT2RuD+eSaMt1FaXaIrOcRyRklHNZ9fSjvtvvVv3kRnYqodScDGSN1+7POmHbOJjz9nakEdimRn2e0HPoWo+zNjl3Vz+asdorH+NX89bDxe8fEO/1H7Qigbg1ETpTcZDLYEBQeY93LGtqPXepdQmLXusTtCu0aRqFCitIEfCl5eqG2PvqQaitoIoIgRHFGI1B3IAGBXMqcVjG1W2owGG5QPGSDjOMH4EbitDiIPsKn6xLfiTWiLPDOkEkZjZXChzwEjcEhqx0IrPmDUhlg7mIPKZF7sHGMk7c9h6mlXtpa4PEO5bBG+aQwwmYhcxpwjgcbKM8yMeZ3q0nspXt2R1EVx+qdgcA71/1FZfxq/nrYeLBPiPtV9uQO8av701HGm5ccPsZBXzJ93BFDBwcVc39wIIVyTux8lA2JOas0XE80kh6D3BVs0bG2kdGxsGPEpp45ZIpEKshIYHmD8gqS9iWeaQxRNuABuwrsksvs6yWc030XlWRyfQmtPmhc2yCCTG2M8J9RTxSSROCrISGFE5GdxTExjvxAONcy4zwbjelPbK0KAgdwSAdyN6KQW3VbS0/qSDWLZyBziuKzr9kOt4v5q28XvHxH2vUB5GU1m5JzuTTH9GsI8hbJgWzgLnhOKOQQcUmlaXbGNA11eEBATgEkFhnoFWoH0a9mu55JZUiZ+8ZiApH0V5KK1jQb9BNcyz2BbDwOS2B1SraV7HUIGDRThRxDkVfdTS4oX2owQk4XPE2Og3IqHUxKGw1mjNGqA+7IUOCW6gEYAqytdZgjtkVCYQWVavEu00XU52lgm2gd92RqWPUYiMASZRj8eYNYJ+POocxlojIocZjAyG35EeYpz2vtCTljA1XpUGK5AXuYcK8YYbMSN1K1ObSVZuDiCXGCucEbcweRrHaOx/jR+bx7nxYvNQ+1as3LetMP0eArH+5HfyA92jzzVz2e1XsvdRRd5CIbkMv3JWo65aGzgtTbwP+v5s1EHcYqQdg9KMp95IouD/AMhw1/Kv+ZSbDPcPj1ytX+k6V7BNYmaaIsEckir/AFa/mvbvJkkNSrqlgYweMXEZX1DCi1tFKdmE8H/sWvjtTgriRY2LL77AkLk7ml/4ussE4MZFJ3W8jEPBFuCAQG222p4rWdWYMOC4xzzg9ck5Nf8AUOn/AMav5qx4tz4j7bqH2rV/eGohbLDAf3QZXG7csHPRaGwNHtX2VgEGDfWe6fEgYKn61S280kM8TRyoSGRgVKkeRBq51q8WCFCEBHfTY2jFQm50rSLfAihMckvRYof1QazyI5HFCz1KKRjsh98D6LDBNXNhez6tZRGWwuCZGKfsi1LUzypqV1EVjTeFSMFj9Kva9VsrCLfu3E0pHkF5A1cy57qB5Mcyikir2ThEllKVyCyn3Sw6EijD2gtbyUBIU/WYADGDnYCtFSFEa8G0UK7KTgqa0q6ieOK64mKyhRwtuWrWE1SyuzaEwpco5IZSQA1WV25SGUlgASpRl2PxYAGjR8GSfEPbNR+EzV/bmlUWWwLG02ON1A4cittxUtnPlCDxAAqxwGArszeqJNT0+LiUbNPCDj0YgirYRezaLZcS8g/AYoI/iTgZ9BTXljdW6XObm5ILzNtxODkD4LVxpyx2hspGnSNUVWSTiJAxyCkMavorm71XVC8VxOvAkB2YISCS9TWsYgcd7FnABOCM9Ca7KQObg2EEEmc8RtwpJ+BxVxcoyaZaSfbyqY4x6BsFqisklnZDcXMp3JODLJ8T5KBua13VIzMBcTxKCF7od1Ao5ARrVgswidbhZIQwkV5WBkJ2y3/0MVbBcKJNiTxF8kjpy5UFJI2rLrk+dQzMhdpSwyc8RFQW1yGQykmLADyFgMAeLfxYv9Q+1aszt60/BbHI4RaJnfcE4wAOh3zQxzHKk4xxGkRCFmI+GTWXyTmvfGKeNCqyFQdiAcCgSTtWKl4SBMcUGBZiSfjv+NQyapBBKSIy6xvg/wCVssRt1AAq0t7ArCwwEwoHkAKe7uI5VBEqyYDeeCcCu+iV8YLLvRzW4Gayy0O9QfuHxbnxA3+oj/Vav7Y0h9l3PF7IMAciBw5J+IogVnOc1uN+lb/iPkY4yaPnyrHKi7heS5yx6AeX38qLk5I36GiJnKMitlGQEkFivlVtfW4WSULMgw6sQDWnQRSQWrpNdOCo4CCIgdixIru4VXoK3Ne8KAZd6Vp1x9A/OY1LUPtTWZm9adUgUuAhtlJXzJGMEUMfDNb7ffXOlOxArnRGwyaY0z78lB3Y8qRE7uInh82zuxo7kZrveFgwDqQykjIyDkZBq3dwl4TCAOfBxKx5AgjGKso2TGow8mLkJjPQCoeDa4DtnmF2A/nuaDMxXJHlnapOMbADz8yajiK5mk4vICLG/wDM1fi6LSQXQi7ogtLEYgCehPi38WNT1A/6rUO+agEtMocm1HC3MAbZB+J2xWM/Lk1hcEZq2JBMZz8Gq3H6sO/UtmnbAzsPKsnJFZobg5qKVCrAEGo/2QwzMAByBJNJBrtiseMAk7DoKXu49h/hWv8AVmFJaa3aPMB3LSyLJkZABJGagikB4fPPEBVvdCO2upVS52CknAl//VY8O58RGqah9q1f2xolIAXAUWqZXHM+RzS1kUSCKwdzQFHNZ3zWKyK5g8qGcg1nYmoV4TKDwKQWwcHAO+D5VnX7NQMe69LJHGBet/hwggd3twN6eRpeHiDlgTMcnHWpp0XT7pS8qEpFIObAHZTSTEf5gfhkZq/tMxScU1uuMBmBIB8lJ/A1DcwrLCwZW/mD0PQjwb+LGq6h9qazMaxHb5UE+zjDdAMZHyYpODvGk4eMHgUKWLYJU5ORwjIIHOle3EnegOVL92FOeADJYnYZA3xjGKDID3q8XCX4MHIQDiJJ5ZC74p47aOdouFZEDJk44h1XnsPOp7a5it5Dws8TSEyApworMpLDBIyRtUqzCISxMrJ3hmBbuxH9Ldc8zjGM52q5MpSECdu67xeDI4lzgnDAEYOc5wBg0UcqxBIOCVJI26ZArFe9TSlFVgrAqVY8gVOa4u0FuoJwIiAatBGilGKvHDxe+QfeODuDSRW/CgIVUuAoyTgKcDc0U7RWLDmLsfmrTr52mQdxO2cug2bP0lq4sJDbTgBgMgjcMPpLy+8VJZScVupZf2kecA/zP63Q1HPEksZyrD0I6gjyI+ZI1XUPtTWZjR7u3HCd4Ac+Qxjavh8l9fQs1tpxnQSFOPvUT3hglQGZS1LbQzRSQ92y8StxjDIBsVxgEdD542pIg8bwFJgCGLgq4GMFfhlTjrjaomtyOCRYweAsASgfGy5OwJUbrz2qOaS1CxSFkLiNBmQkvlmAA3OckkCil0jvBJA6DKxsrR7ejb4JpGu2eKUwskZVFQkMo5jhPqcmonld0CgE7gbAHzwNsb1kGsGlwoYEjiXYczkjauHtFBnyiNHhi+ztsfcxpu4Oel3+av8Antp/FD83yJqNvgHgmjJaJ+hxjB6g0kkRJBUqxDKdiGU7g0Irnus+5ODt0kUc/vHzONVv/tDR7017kWXx/YLhcc+W+a9fksZdIia6uCnBfz8K90ZA2Y4yaiMsUkUplElhETKQQZCuYyxB+rSrr2q5IADRf+pauk0l9HNhMoitBdd8Yjg3AHelQfqkrU0mtwJB/ilLkJg4OTC1ajaaTdRarKxkaWI2SyyrLIME8bAqThSKGr2N1ZK6xvBOlyshUsQrApJgDcnABAqC77mG3iMdpAvDbIeYU7lm6sx3asZo1I7qIiFYHIYnGw3P8xQPaGH7M17kBPnDa/mag0B+zu/zVw61bHpc1vRHKu61GYrssoViv724J+8Yq4t5rGVyArTxjHmCTyPiPyGsatqH2rVmQkdaPBAeHIWADi22JxtSy+RU4yARjI8iKBFafFYvb3kCTDvzKpMskRBZVUjKA5BApL+5fuhwL3PdxIqkiNFBwo5seeSx5mob/WPbpgnC8ySPEGyCEAyASBzArUF1AXLX87Zm70w963AVJyVwTgAikttRnnRAV4LlVjDDKiVGVQfTIpJNOa0YF2hkDWzgjChsCRTuPdPMYq4t4L6OHjE0ixCJk8ikqscnkNhUUk63KqEklBMsYAwJBzZegajSqMk1EyIS54GYbis9ooh+5USxwF5OUcQx9XLCreW3LQvxLwXGd87nDVjVov4j5TLfwyMMrGmR65pWxxAHByMjOCPAPCsvaaaJhlXuwpHUE12dtrK9uf0bGzJDI4DkncCkeGJtyxhCkZ28qVcFNmLZGeWTtj0NB1VhyYAjPx+S5klmjti3fPEQhVuA5DKeeRT9/IZGDSm1jEzAhgZQVJORsTkbkczk1bDT2ja4jMhIl4OE5BIKlQ3LGCGIq1GjBBIrsIGIhMKjDd+f7QS5ySBsRVobBSYAZ2PdZIGEWIKcqPJmyATRrNJFG8jZ90VJKeARGZgR3hLBI1PMqCSMkVNcXNpZxGPvXZVBO6A+Z9BVyvalohdW7NBC0smOMDhA3IJWreQxB04g8cHECcg5JFJDFIEUKpF2cAY34qtm1DT5WhDcV2gcEncE1xordRn5B4N/Ebnt0kI89QUn0DZNCx7Ka3P0s5VHq44RSRnDHA4NjUMikFgRjyNRKioh2Xlk5NCipyDim5gnNODnOdvPenbfI3olQCRgfIDUkpjwYxGrAsSwHLfkMk0I4o4gwYrkkgEAljkkCnm1Br5lPdWyHB6yOCoFcHaK9l+npzJ97USlof8AStT/ADdqS1sWdpArNHdKgJwWckYAorcWfwnU1i3gB592ufXFDrQoUPkHWl60vUUv0hSUhp4O02o6vOQQzHuB9fma1C5sk0mxsLqSEsHuJ1iYp8EDU1twrIChIwVcEfcQagYRljBxKpUMVAODWnOIsWsTcGSpEjjc774berBlkBtiC5BLLIQduhOcVphaNmW6wgwFEqgNtjfCgmrLgkVZp1ZjlWIDcI6AbZq3EilbyQIFIYGIZY4554tqBjOL5ePOxaMhQPjgkk05f3buApgnPvZz6FQKmKSs8kAYHCqJRlh1JbFXgRSIkZmOOFZUOPvzV5f3MkEV1aqqRlmeSQAZyAFpxMGvdTtliHMQEyuat4II7a2jEUEY91RzJPNmPmx8zX6MgubtCO+ZRHECMgmtdvYuF75kThROFMIMISRWWLPLksxYknJJPM+pqW6mju5UK26HIJGOOs+dfGgfOgfkHWn601E0afBwRnyzuK1PbuvZlbqwZv6AitdlTDanaj0tD+DSEVeTgi81u6lB8kCRD+QU12aaQyXFobhjzMrk12R5HQbL74hXYuXnokI+qWT8prse2eC1nh+pO9aCd49T1SP0mWoP2HaG+X7QK9ar+x7Rp6Pa12tTPBqmnSfXDL+C127i5WtpP9nKK7aQZ49AmP2bCT8prtJGD3ugXqDqYHpNKknF/Y3CCQDGBuCOoatKk/UWf71FI6HuLeV2PIHCiu0N9cmUtEq/5UMaSBfTjBrU2Ys0lpk9bSBvxWp7d1ctaMw6WMC/gtXJADtn0XFSHyNSdDUnQ1L0NSdDUvx8Z8B+ZDDDAEdDWly5Mun27nqYlNaEf/j4x6ZWtFXlaY/7mrSl5Ww+8k1YDlAtWgO0Iq2H7MVB9AVD9Go/o0nSk6V//8QAMREAAgICAQIEAwcEAwAAAAAAAQIAAwQRIRIxBRNBURAUIgYgMzRhcXIjQmKBMlKC/9oACAECAQE/AJqBYBADAk6dcziFIVhWah+GpobgE18BAJubJl94rXe5j5L21dTn6QdCY1yX3rUPXjcvpNVhQneoVhWETXxEA3AsC7Bl1q1iVZq9LAnRHaZF/mb5gvK0Kg9p4SG+bVx7zI+qwwiEQiamoBAIFgZB3IEFlIPLrMunEu5NpDSrEpr1wCQe5llVZQAoP+QENFIuJZfpDAEDjYl2ZRgVNZTQWO+w5Ms+0xUjqpYe4YEGW+KYtVFdth0rKCJjeJ4eW4WqzZMIhEIggHwVyz6J56mildEuTqAV8GefUqqWcDgGNk0HWn3o74BMLq9qgHezs8ES8jraZdItQdXOj3mDiV5OJVTcgdACOZd4WuB4pQ+JtU6h1LGhhgghi83f+mi61ojtAWsYKikk+gjV2UkdakEwWAyuuy0EoOAdbJAmQtqPpwQYpOwDyNjieFjrqpbXIBmVUpzgGUEHph+B+AnpEfeQy+zGK/B99mYq3sS1Q0DwSZk/MKALR9PoZ1AHe5TRl2KCPoUzMqvqC+YdjsDKyeoTwRyMSsjvzMvnOT34jdz9wRpSB8zYf8jFfR1MRKq6E/aZQR6bAfUSjT3ohGwWG5uta9AzN6Hpas9z2ig7A36zwJAcJNgmZq9ObWf2jcn7p7Sn8xZ/IwsBbMXJSypdtoqNaMycgEheoDfETHsqLWuQoXlf1Mpya7a+oHn1EybwSffsIoQWcOerW+08Pz78ata0IIHuJis2deGsUbHbUzKBRb0Dfbf3BDKCfm7v5GW/ixMny00ADGtJ5huY8EkgRbmXsYzM8xsjOu8RBenlQBwNACVaFh123PCH1eJ4p+P/AKH3TKPzV38jLtiyA/AA+8AEB1yJj3KwCklZjYxtXrR+4JGxPDKCSxDgOp7GZLWPaTYumA193Uo/N3fyMyPxTK0Zjocw0WGDHt3rUGNYRwIQRwZUdOJ4PryawVB+kk7MYvTmfQdb1EvF/wBFigNLqug/p8CJqalQ1lX/AMjLwPNMqJQFovIJDN+kcMCB1H9ddyYA6kKHP+zLQQ5G969ZXw4nhGyqc9lMyfzg/cT+6eezgqV3zomdMI5mpqU0O+Tey64Yy5B5rA94D08Qc1A753Ao9TLNb7kiHbHtzAgTRLTwZv6dbJpuDMy5UzFL+47TpgSdE2PedS+4nWvuJRUa/Ob1diQJlYxLl+lp5KepI/cTyl9Hnk+1gnln3Bh3WQdqJnZtNdLhXDO4IAB959nLynh9TODwCBLhbmZVfl1nuIuI+p8s3tPIPtCjbPM8sxqVfWy3+jBWqjgRdD0mlPdQYaqT3rUw42Oe9Sw4GMf7NftLvCcO6tkYEBvYyj7LeDI4NotYewMqHhVFSV14zBFGgImZi1AiujUPiS/9Ic//ABnzh9p//8QAMxEAAgICAQIDBgUDBQEAAAAAAQIAAwQREiExBRNBBhAiMlFxFCBSYXI0YoEjJDNDkbH/2gAIAQMBAT8AnSEwtC4jWARrh9YLx6QWgxbIrQNOU3OU3Nzc3GeO+hDYzHQhB5aMx8YvoamTjLVeUTvoEy6m2jFfI9FG54fnV52OLk2ASQR9CIHgeAwGAzcLRmjNLHGiJi4pYg6j4PxhwOh7yisV66Q0Br2c+pniBUYNqEdCup4TR+GoZNaDOSBA8DRXgaAwtC0ZtQi1vlUn7CGq9u1bTGfOqXQq5LLMy+zltyBodBKrrFZiHPaJfa1HFWHMqSCRvRlmJn31IttgboN6EGCUID7WLh3Mjug5KrEEieTaqliOg7xWEBgMJhM31Ew6kCMyrr4AJaCtpCAb316CMbm2vLUbEvNrhK2bTEbAiYGX13URsSuu2tCXTjoaEpQBE+0y6xZQ4K/EASszM23DZuDFCxQkSvlk+H2O5BJU6MQ7VfsIIrTcJg7iYX/C38BLgxtJEPl1IXdgoHqZTbTaCa3B1B9zLsimohHJJI3oAmUWVXIGQ7H/AMgQNsn0BntghXI4jttTPCXc+G/N+qL7hNwwdxMNf9AH+wS1dWmZ+ThoFS1tsOoUTBtxLdmn5vUEaM47EyvEcKtyvEuw6HQnhuVi3BvKHFu5UzQ0Z7a8DknmCR0ngmh4YQN8Ry1sxB0HuHuJizE6Yw/gJf0ZjL/NuuZ9E7Y9Zh7rvrZenXRmbY1eJa6nrxiV2m3ZGhPD1evIWxO3YxT0J16T25bWWAHC9ASSNzwOzl4X8wJ2w2BAPyGDvMX+lX+Alqk731mRh20XuAhZGOxqYuO2+ZQ6XrLMmq4ChQSWGj+wj4t1TcGXkB2ImJQVAYqQoOzKsnYK6UnsQDsieO+BYWe3m3q4IA7GHw+rAxClBbj1PWYl/nKx/SxH5RMcD8En7qIR1MNQfvDV0i46qd66zyVPUjoIU51uvbodSnHGMHBLciZlKzYacz8XEbmXWTht9pgrxFo/vP5RKP6JP4CaBnHr0mjOY7BDNE9zNS+tufMVhj9yJmeILQSltXYgdCTLXqtoB+IKwPYxkNTspUjZ3AfyCUnWDX/ARRsbjula7YwZNPQ8j31DlUAD4xDk0KRtwNgGKVYAiFehntU5S7kHIHJZ4fefw6n5gATowtRlJpO/cgjqJbS1TfVfeYJSf9jV/ERPlmaxVEC9y2uxMRlY1KVADKWP3ES6p6r34LusEr9NEdDPOrNPnPUNAhSR1GpiktUpK8T9O+hG+Qz2t3zGh6ieHf0v+DKXeqwOp0Qdy9aLK+RIHNdgfvB7iPdZn1Y+NRW4J5oNSsgorDsRsS2lLlCsTre+h1GqRblQL0VdDr1AMcVgEJT0c8GA2OkroDoy8eILbIPUbEqrFKAb6ATmpVyToKCTPaa2m635247WeHKfwbFd8RuA76x3ZggJ+UaHu0ZxJ9Jxb6TJtGVfioh6VoATMXIUVohdNgDuYLT6KD9mEFpPeo/4IM8weqGB1XXQjZll9KoWdiFABJ1MrPrsTyqNnl8za0AJ4nitkW+WhAOwSTKOGBhOLLQehi5Vf1gyEPrPPX6zks5Cch+xgfR2ugf2AEd7HOyxJgZx2YiC/IHa5h9iYM3LXtkN/wCxPFs1P+3cbxjJcacgiP4jbr4FUGWW5ljMxZNnuZbjW3EGxwftB4eP1wYKfqgxUHrP/9k="; // קוד base64 של תמונת ברירת מחדל
    </script>
  </head>
  <body>
    <div class="header">
      <button class="theme-toggle" onclick="toggleTheme()">
        <span id="theme-icon">🌙</span>
      </button>
      <button id="helpButton" class="theme-toggle">❓</button>
      <button
        class="scroll-to-top-btn"
        onclick="scrollToTop()"
        style="display: none"
      >
        <span id="scroll-to-top-icon">⬆️</span>
      </button>
      <h1>ספר מתכונים</h1>
    </div>
    <div class="container">
      <!-- כפתור פתח/סגור עורך -->
      <div class="buttons-container">
        <button
          onclick="toggleEditFields()"
          id="toggle-edit-btn"
          class="uniform-btn"
        >
          פתח עורך
        </button>
      </div>

      <div class="input-group-row">
        <!-- שדה כותרת -->
        <div class="input-group">
          <label for="title">כותרת:</label>
          <textarea id="title" placeholder="הכנס כותרת"></textarea>
        </div>
      
        <!-- שדה קטגוריה -->
        <div class="input-group">
          <label for="category">קטגוריה:</label>
          <select id="category">
            <option value="ראשונות">ראשונות</option>
            <option value="עיקריות">עיקריות</option>
            <option value="תוספות">תוספות</option>
            <option value="קינוחים">קינוחים</option>
          </select>
        </div>
      
        <!-- שדה לכמות -->
        <div class="input-group">
          <label for="quantity">לכמות:</label>
          <input type="text" id="quantity" placeholder="כמות המתכון" />
        </div>
      </div>

<!-- שדה מצרכים -->
<div class="input-group">
  <label for="ingredients">רשימת מצרכים:</label>
  <textarea id="ingredients" placeholder="רשימת המצרכים"></textarea>
</div>

<!-- שדה אופן ההכנה -->
<div class="input-group">
  <label for="instructions">הוראות הכנה:</label>
  <textarea id="instructions" placeholder="הוראות ההכנה"></textarea>
</div>

      <!-- כפתורים: הכנס מתכון והעלה תמונה -->
      <div class="buttons-row">
        <label class="custom-file-input uniform-btn">
          העלה תמונה
          <input
            type="file"
            id="recipe-image"
            accept="image/*"
            style="display: none"
          />
        </label>
        <button onclick="addRecipe()" class="uniform-btn">הכנס מתכון</button>
      </div>
      <div class="buttons-row additional-buttons" style="display: none;">
        <button onclick="exportRecipes()" class="uniform-btn">יצא לקובץ</button>
        <label class="custom-file-input uniform-btn">
          יבא מקובץ
          <input
            type="file"
            id="import-file"
            accept=".json"
            style="display: none"
          />
        </label>
        <button onclick="confirmDeleteAll()" class="uniform-btn delete-all-btn">
          מחק הכל
        </button>
      </div>

      <!-- שדה חיפוש -->
      <div class="input-group" data-search="true">
        <label for="title">הזן מילת חיפוש:</label>
        <input
          type="text"
          id="search-word"
          placeholder=" הזן מילה לחיפוש (או השאר ריק להצגת הכל) "
        />
      </div>

      <div class="buttons-container">
        <button
          onclick="toggleSearch()"
          id="toggle-search-btn"
          class="uniform-btn"
        >
          הצג חיפוש
        </button>
        <div class="category-buttons">
            <button onclick="searchCategory('ראשונות')" class="uniform-btn category-btn">ראשונות</button>
            <button onclick="searchCategory('עיקריות')" class="uniform-btn category-btn">עיקריות</button>
            <button onclick="searchCategory('תוספות')" class="uniform-btn category-btn">תוספות</button>
            <button onclick="searchCategory('קינוחים')" class="uniform-btn category-btn">קינוחים</button>
          </div>
      </div>
      </div>


      <!-- אזור תצוגת תוצאות חיפוש -->
      <div id="search-results" class="input-group"></div>

      <!-- שדה התוצאה (רשימת המתכונים) -->
      <div id="recipes" class="input-group"></div>
    </div>

    <!-- הדרכה -->
    <div id="customModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2><u>הדרכה</u></h2>
        1. הוספת מתכון חדש על ידי פתיחת עורך, מילוי השדות ולחיצה לשמירתו על כפתור "הכנס
        מתכון" .<br />
        2. חיפוש מתכונים באמצעות הזנת מילת חיפוש או השארת השדה ריק לצפיה בכל
        המתכונים, לחיצה על "כפתור הצג חיפוש" תציג את המתכונים .<br />
        3. לחיצה על כפתור מחיקת מתכון (סל אשפה) , אישור המחיקה הינו בלתי הפיך
        .<br />
        4. כפתור הדפסת מתכון (מדפסת) להדפסת מתכון מסויים .<br />
        5. לחיצה על כפתור עריכה (עיפרון) תפתח את שדות המתכון לצורך עריכתו, לחיצה
        נוספת תנעל את עריכתו .<br />
        במצב זה יופיעו גם כפתורי החלפת תמונה / הסרת תמונה.<br />
        6. לחיצה על יצא מתכונים בכדי לשמור את המתכונים בקובץ חיצוני (בפורמט JSON)
        .<br />
        7. לחיצה על יבא מתכונים בכדי לטעון את המתכונים מקובץ חיצוני (בפורמט JSON)
        .<br />
        8. כפתור מחק הכל (באדום) ימחק את כל המתכונים וינקה את הזכרון, לאחר אישור המחיקה הינה בלתי הפיכה.<br />
        9. ניתן לשנות את ערכת הצבעים בהיר/כהה באמצעות לחיצה על כפתור שינוי מצב
        תצוגה בצד שמאל מעלה .<br /><br />
        <h2><u>הערות</u></h2>
        המתכונים נשמרים באופן מקומי בדפדפן שלך.<br />
        רצוי לגבות קובץ שיוצא בענן.
      </div>
    </div>

    <script>
      let db;
      window.onload = function () {
        const request = indexedDB.open("RecipeDB", 1);
        request.onerror = (event) =>
          console.error("Database error:", event.target.error);
        request.onsuccess = (event) => {
          db = event.target.result;
          loadRecipes(); // טעינת מתכונים עם פתיחת הדף
        };
        request.onupgradeneeded = (event) => {
          db = event.target.result;
          if (!db.objectStoreNames.contains("recipes")) {
            db.createObjectStore("recipes", {
              keyPath: "id",
              autoIncrement: true,
            });
          }
        };
      };
    
      document.addEventListener("DOMContentLoaded", () => {
        // קוד לטעינת ערכת נושא
        const savedTheme = localStorage.getItem("checklistTheme") || "dark";
        setTheme(savedTheme);
    
        // קוד להסתרת שדות קלט וכפתורים
        const inputFields = document.querySelectorAll(".input-group");
        inputFields.forEach((field) => {
          if (!field.querySelector("#search-word")) {
            field.style.display = "none";
          }
        });
    
        const addRecipeBtn = document.querySelector(".buttons-row");
        addRecipeBtn.style.display = "none";
    
        const editBtn = document.getElementById("toggle-edit-btn");
        editBtn.innerText = "פתח עורך";
    
        // בדיקה ראשונית של מצב הכפתור "הצג חיפוש"
        const toggleSearchBtn = document.getElementById("toggle-search-btn");
        if (toggleSearchBtn) {
          toggleSearchBtn.innerText = "הצג חיפוש";
        }
      });
    
      function addRecipe() {
        const title = document.getElementById("title").value.trim();
        const quantity = document.getElementById("quantity").value.trim();
        const ingredients = document.getElementById("ingredients").value.trim();
        const instructions = document.getElementById("instructions").value.trim();
        const category = document.getElementById("category").value;
    
        if (!title || !ingredients || !instructions) {
          showToast("נא למלא את כל השדות הדרושים: כותרת, מצרכים והוראות הכנה.", true);
          return;
        }
    
        const imageInput = document.getElementById("recipe-image");
        let imageData = defaultImage;
    
        if (imageInput.files && imageInput.files[0]) {
          const reader = new FileReader();
          reader.onload = function (e) {
            imageData = e.target.result;
            saveRecipeToDB(title, quantity, ingredients, instructions, imageData, category);
            showToast("המתכון נוסף בהצלחה!");
          };
          reader.readAsDataURL(imageInput.files[0]);
        } else {
          saveRecipeToDB(title, quantity, ingredients, instructions, imageData, category);
          showToast("המתכון נוסף בהצלחה!");
        }
    
        // ניקוי השדות לאחר השמירה
        document.getElementById("title").value = "";
        document.getElementById("quantity").value = "";
        document.getElementById("ingredients").value = "";
        document.getElementById("instructions").value = "";
        document.getElementById("recipe-image").value = "";
      }

      function displayRecipes(recipes) {
  const recipesContainer = document.getElementById("recipes");
  recipesContainer.innerHTML = ""; // נקה את התוכן הקיים

  if (recipes.length === 0) {
    recipesContainer.innerHTML = "<p>לא נמצאו מתכונים.</p>";
    return;
  }

  recipes.forEach((recipe, index) => {
    const recipeDiv = createRecipeElement(recipe, index);
    recipesContainer.appendChild(recipeDiv);
  });
}
    
      function loadRecipes() {
        const transaction = db.transaction(["recipes"], "readonly");
        const store = transaction.objectStore("recipes");
        const request = store.getAll();
    
        request.onsuccess = (event) => {
          const recipes = event.target.result;
          displayRecipes(recipes);
        };
    
        request.onerror = (event) => {
          showToast("שגיאה בטעינת המתכונים. אנא נסה שוב.", true);
          console.error("Error loading recipes:", event.target.error);
        };
      }
    
      function saveRecipeToDB(title, quantity, ingredients, instructions, imageData, category) {
        if (!db) {
          showToast("שגיאה: מסד הנתונים לא זמין.", true);
          console.error("Database not initialized.");
          return;
        }
    
        const transaction = db.transaction(["recipes"], "readwrite");
        const store = transaction.objectStore("recipes");
    
        const recipe = {
          title,
          quantity,
          ingredients,
          instructions,
          imageData,
          category,
        };
    
        const request = store.add(recipe);
        request.onsuccess = () => {
          showToast("המתכון נוסף בהצלחה!");
          loadRecipes(); // טען מחדש את רשימת המתכונים
        };
        request.onerror = (event) => {
          showToast("שגיאה בשמירת המתכון. אנא נסה שוב.", true);
          console.error("Error saving recipe:", event.target.error);
        };
      }
    
      function deleteRecipe(id) {
        if (confirm("האם אתה בטוח שברצונך למחוק את המתכון?")) {
          const transaction = db.transaction(["recipes"], "readwrite");
          const store = transaction.objectStore("recipes");
    
          const deleteRequest = store.delete(id);
          deleteRequest.onsuccess = () => {
            showToast("המתכון נמחק בהצלחה!");
            loadRecipes(); // טען מחדש את רשימת המתכונים
          };
          deleteRequest.onerror = (event) => {
            showToast("שגיאה במחיקת המתכון. אנא נסה שוב.", true);
            console.error("Error deleting recipe:", event.target.error);
          };
        }
      }
        
      function toggleEditMode(index) {
        const transaction = db.transaction(["recipes"], "readwrite");
        const store = transaction.objectStore("recipes");
        const request = store.getAll();
    
        request.onsuccess = (event) => {
          const recipes = event.target.result;
          const recipe = recipes[index];
          const recipeDiv = document.querySelectorAll(".recipe")[index];
          const editables = recipeDiv.querySelectorAll(".editable");
          const isEnteringEditMode = editables[0].contentEditable !== "true";
    
          // הפעלת או ביטול מצב עריכה עבור שדות הניתנים לעריכה
          editables.forEach((editable) => {
            editable.contentEditable = isEnteringEditMode ? "true" : "false";
            editable.addEventListener("input", () => {
              updateRecipeInDB(index, editable.dataset.field, editable.innerText);
            });
          });
    
          // יצירת או עדכון של אזור התמונה
          let imageContainer = recipeDiv.querySelector(".recipe-image");
          if (!imageContainer) {
            imageContainer = document.createElement("div");
            imageContainer.className = "recipe-image";
            imageContainer.style.textAlign = "center";
            imageContainer.style.margin = "10px 0";
            recipeDiv.appendChild(imageContainer);
          }
    
          if (isEnteringEditMode) {
            // אם נכנסים למצב עריכה, הצג את הכפתורים המתאימים
            if (!recipe.imageData || recipe.imageData.trim() === "") {
              // אם אין תמונה, הצג כפתור "הוסף תמונה"
              imageContainer.innerHTML = "";
              imageContainer.appendChild(
                createImageButton("הוסף תמונה", () => changeRecipeImage(index), "#4caf50")
              );
            } else {
              // אם יש תמונה, הצג כפתורי "החלף תמונה" ו"מחק תמונה"
              imageContainer.innerHTML = `
                <img src="${recipe.imageData}" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
              `;
              imageContainer.appendChild(
                createImageButton("החלף תמונה", () => changeRecipeImage(index), "#4caf50")
              );
              imageContainer.appendChild(
                createImageButton("מחק תמונה", () => removeImage(index), "#ff4444")
              );
            }
          } else {
            // אם יוצאים ממצב עריכה, הסר את הכפתורים אך שמור את התמונה אם קיימת
            if (recipe.imageData && recipe.imageData.trim() !== "") {
              imageContainer.innerHTML = `
                <img src="${recipe.imageData}" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
              `;
            } else {
              imageContainer.innerHTML = ""; // אם אין תמונה, הסר הכל
            }
          }
    
          // עדכון המסגרת של המתכון בהתאם למצב העריכה
          recipeDiv.style.border = isEnteringEditMode
            ? "2px solid #ffa500"
            : "1px solid var(--primary-color)";
        };
    
        request.onerror = (event) => {
          console.error("Error loading recipes:", event.target.error);
        };
      }
    
      function createImageButton(text, onClick, backgroundColor) {
        const button = document.createElement("button");
        button.innerText = text;
        button.style.display = "block";
        button.style.margin = "5px auto";
        button.style.padding = "8px 12px";
        button.style.background = backgroundColor;
        button.style.color = "white";
        button.style.border = "none";
        button.style.borderRadius = "5px";
        button.style.cursor = "pointer";
        button.onclick = onClick;
        return button;
      }
    
      function updateRecipeInDB(index, field, newValue) {
        const transaction = db.transaction(["recipes"], "readwrite");
        const store = transaction.objectStore("recipes");
        const request = store.getAll();
    
        request.onsuccess = (event) => {
          const recipes = event.target.result;
          if (recipes[index]) {
            recipes[index][field] = newValue;
            const updateRequest = store.put(recipes[index]);
            updateRequest.onsuccess = () => {
              console.log("Recipe updated successfully.");
            };
            updateRequest.onerror = (event) => {
              console.error("Error updating recipe:", event.target.error);
            };
          }
        };
    
        request.onerror = (event) => {
          console.error("Error loading recipes:", event.target.error);
        };
      }
    
      function changeRecipeImage(index) {
        const fileInput = document.createElement("input");
        fileInput.type = "file";
        fileInput.accept = "image/*";
        fileInput.style.display = "none";
        document.body.appendChild(fileInput);
    
        fileInput.click();
    
        fileInput.onchange = function (event) {
          if (event.target.files && event.target.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const recipeDiv = document.querySelectorAll(".recipe")[index];
              const imageContainer = recipeDiv.querySelector(".recipe-image");
              imageContainer.innerHTML = `
                <img src="${e.target.result}" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
                <button class="remove-image-btn" onclick="removeImage(${index})" style="display: block; margin: 5px auto; padding: 3px 8px; background: #ff4444; color: white; border: none; border-radius: 3px; cursor: pointer;">הסר תמונה</button>
              `;
    
              const transaction = db.transaction(["recipes"], "readwrite");
              const store = transaction.objectStore("recipes");
              const request = store.getAll();
    
              request.onsuccess = (event) => {
                const recipes = event.target.result;
                recipes[index].imageData = e.target.result;
                const updateRequest = store.put(recipes[index]);
                updateRequest.onsuccess = () => {
                  console.log("Recipe image updated successfully.");
                };
                updateRequest.onerror = (event) => {
                  console.error("Error updating recipe image:", event.target.error);
                };
              };
    
              request.onerror = (event) => {
                console.error("Error loading recipes:", event.target.error);
              };
            };
            reader.readAsDataURL(event.target.files[0]);
          }
          document.body.removeChild(fileInput);
        };
      }
    
      function removeImage(index) {
        if (confirm("האם אתה בטוח שברצונך להסיר את התמונה?")) {
          const transaction = db.transaction(["recipes"], "readwrite");
          const store = transaction.objectStore("recipes");
          const request = store.getAll();
    
          request.onsuccess = (event) => {
            const recipes = event.target.result;
            recipes[index].imageData = null;
            const updateRequest = store.put(recipes[index]);
            updateRequest.onsuccess = () => {
              console.log("Recipe image removed successfully.");
              const recipeDiv = document.querySelectorAll(".recipe")[index];
              const imageContainer = recipeDiv.querySelector(".recipe-image");
              imageContainer.innerHTML = `
                <img src="${defaultImage}" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
              `;
            };
            updateRequest.onerror = (event) => {
              console.error("Error removing recipe image:", event.target.error);
            };
          };
    
          request.onerror = (event) => {
            console.error("Error loading recipes:", event.target.error);
          };
        }
      }
    
      function exportRecipes() {
        const transaction = db.transaction(["recipes"], "readonly");
        const store = transaction.objectStore("recipes");
        const request = store.getAll();
    
        request.onsuccess = (event) => {
          const recipes = event.target.result;
          const dataStr = JSON.stringify(recipes, null, 2);
          const dataBlob = new Blob([dataStr], { type: "application/json" });
    
          if (
            /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
              navigator.userAgent
            )
          ) {
            if (navigator.share) {
              const file = new File([dataBlob], "recipes.json", {
                type: "application/json",
              });
              navigator
                .share({
                  files: [file],
                  title: "ספר מתכונים",
                  text: "ייצוא מתכונים מהאפליקציה",
                })
                .catch((error) => {
                  alert("לא ניתן לשתף את הקובץ. אנא נסה שוב.");
                });
            } else {
              alert("יכולת שיתוף לא נתמכת במכשיר זה.");
            }
          } else {
            const url = URL.createObjectURL(dataBlob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "recipes.json";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
          }
        };
    
        request.onerror = (event) => {
          console.error("Error loading recipes:", event.target.error);
        };
      }
    
      document
        .getElementById("import-file")
        .addEventListener("change", function (event) {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const content = e.target.result;
              try {
                const newRecipes = JSON.parse(content);
                const transaction = db.transaction(["recipes"], "readwrite");
                const store = transaction.objectStore("recipes");
                const getAllRequest = store.getAll();
    
                getAllRequest.onsuccess = (event) => {
                  const existingRecipes = event.target.result;
    
                  newRecipes.forEach((newRecipe) => {
                    const completeRecipe = ensureRecipeFields(newRecipe); // הוסף שדות חסרים
                    if (!isDuplicateRecipe(completeRecipe, existingRecipes)) {
                      store.add(completeRecipe); // הוסף רק אם אין כפילות
                    }
                  });
    
                  alert("מתכונים יובאו בהצלחה!");
                  loadRecipes();
                };
    
                getAllRequest.onerror = (event) => {
                  console.error("Error loading existing recipes:", event.target.error);
                };
              } catch (error) {
                alert("שגיאה בקריאת הקובץ. ודא שהקובץ בפורמט JSON תקין.");
              }
            }; // סוגר מסוג `}` לסגירת הפונקציה `reader.onload`
            reader.readAsText(file); // הוספת קריאה לפונקציה `readAsText`
          } // סוגר מסוג `}` לסגירת הפונקציה `if`
        }); // סוגר מסוג `}` לסגירת הפונקציה `addEventListener`
    
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }
    
      window.addEventListener("scroll", function () {
        const scrollToTopBtn = document.querySelector(".scroll-to-top-btn");
        if (window.scrollY > 200) {
          scrollToTopBtn.style.display = "flex";
        } else {
          scrollToTopBtn.style.display = "none";
        }
      });
    
      function showHelp() {
        const modal = document.getElementById("customModal");
        if (!modal) {
          console.error("Modal element not found!");
          return;
        }
        modal.style.display = "block";
    
        const closeBtn = document.querySelector(".close");
        if (!closeBtn) {
          console.error("Close button not found!");
          return;
        }
        closeBtn.onclick = function () {
          modal.style.display = "none";
        };
    
        window.onclick = function (event) {
          if (event.target === modal) {
            modal.style.display = "none";
          }
        };
      }
    
      document.getElementById("helpButton").addEventListener("click", showHelp);
    
      function setTheme(theme) {
        document.body.setAttribute("data-theme", theme);
        localStorage.setItem("checklistTheme", theme);
        updateThemeButton();
      }
    
      function toggleTheme() {
        const currentTheme = document.body.getAttribute("data-theme") || "dark";
        setTheme(currentTheme === "dark" ? "light" : "dark");
      }
    
      function updateThemeButton() {
        const themeIcon = document.getElementById("theme-icon");
        const currentTheme = document.body.getAttribute("data-theme") || "dark";
    
        if (currentTheme === "dark") {
          themeIcon.innerHTML = "🌙";
        } else {
          themeIcon.innerHTML = "☀️";
        }
      }
    
      function createRecipeElement(recipe, index, showButtons = true) {
  const recipeDiv = document.createElement("div");
  recipeDiv.classList.add("recipe");

  let imageHTML = "";
  if (recipe.imageData && recipe.imageData.trim() !== "") {
    imageHTML = `
      <div class="recipe-image" style="text-align: center; margin: 10px 0;">
        <img src="${recipe.imageData}" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
      </div>`;
  } else {
    imageHTML = `
      <div class="recipe-image" style="text-align: center; margin: 10px 0;">
        <img src="${defaultImage}" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
      </div>`;
  }

  let buttonsHTML = "";
  if (showButtons) {
    buttonsHTML = `
      <button class="delete-btn" onclick="deleteRecipe(${recipe.id})">🗑️</button>
<button class="share-btn" onclick="shareRecipe(${index})">🚀</button>
<button class="edit-btn" onclick="toggleEditMode(${index})">✏️</button>
    `;
  }

  recipeDiv.innerHTML = `
    <h3 contenteditable="false" class="editable" data-field="title">${recipe.title.replace(
      /\n/g,
      "<br>"
    )}</h3>
    <p><strong>קטגוריה:</strong> <span contenteditable="false" class="editable" data-field="category">${recipe.category}</span></p>
    ${buttonsHTML}
    <p><strong>כמות:</strong> <span contenteditable="false" class="editable" data-field="quantity">${
      recipe.quantity
    }</span></p>
    ${imageHTML}
    <p><strong>מצרכים:</strong></p>
    <span contenteditable="false" class="editable" data-field="ingredients">${recipe.ingredients.replace(
      /\n/g,
      "<br>"
    )}</span>
    <p><strong>הוראות הכנה:</strong></p>
    <span contenteditable="false" class="editable" data-field="instructions">${recipe.instructions.replace(
      /\n/g,
      "<br>"
    )}</span>
  `;

  return recipeDiv;
}
    
      function isDuplicateRecipe(newRecipe, existingRecipes) {
        return existingRecipes.some(
          (existingRecipe) =>
            existingRecipe.title === newRecipe.title &&
            existingRecipe.ingredients === newRecipe.ingredients &&
            existingRecipe.instructions === newRecipe.instructions
        );
      }
    
      function ensureRecipeFields(recipe) {
        return {
          title: recipe.title || "",
          quantity: recipe.quantity || "",
          ingredients: recipe.ingredients || "",
          instructions: recipe.instructions || "",
          imageData: recipe.imageData || defaultImage,
          category: recipe.category || "ראשונות", // הוספת קטגוריה ברירת מחדל
        };
      }
    
      function toggleSearch() {
        const toggleBtn = document.getElementById("toggle-search-btn");
        const searchResults = document.getElementById("search-results");
        const recipesContainer = document.getElementById("recipes");
    
        if (toggleBtn.innerText === "הצג חיפוש") {
          showSearchResults();
          toggleBtn.innerText = "הסתר חיפוש";
          recipesContainer.style.display = "none"; // הסתר את רשימת המתכונים
        } else {
          searchResults.style.display = "none"; // הסתר את תוצאות החיפוש
          recipesContainer.style.display = "none"; // הסתר את רשימת המתכונים
          toggleBtn.innerText = "הצג חיפוש";
          document.getElementById("search-word").value = ""; // איפוס שדה החיפוש
        }
      }
    
      function toggleEditFields() {
        const editBtn = document.getElementById("toggle-edit-btn");
        const inputFields = document.querySelectorAll(
          ".input-group:not([data-search='true'])"
        );
        const addRecipeBtn = document.querySelector(".buttons-row");
        const additionalButtons = document.querySelector(".additional-buttons");
        const searchResults = document.getElementById("search-results");
        const recipesContainer = document.getElementById("recipes");
        const toggleSearchBtn = document.getElementById("toggle-search-btn");
    
        const isEditorOpen = editBtn.innerText.trim() === "פתח עורך";
    
        // הצגה או הסתרה של שדות הקלט וכפתור הוספת המתכון
        inputFields.forEach((field) => {
          field.style.display = isEditorOpen ? "block" : "none";
        });
        addRecipeBtn.style.display = isEditorOpen ? "flex" : "none";
        additionalButtons.style.display = isEditorOpen ? "flex" : "none";
    
        // עדכון טקסט הכפתור
        editBtn.innerText = isEditorOpen ? "סגור עורך" : "פתח עורך";
    
        // אם העורך נפתח, הסתר את תוצאות החיפוש והצג את רשימת המתכונים
        if (isEditorOpen) {
          searchResults.style.display = "none"; // הסתר את תוצאות החיפוש
          recipesContainer.style.display = "block"; // הצג את רשימת המתכונים
          toggleSearchBtn.innerText = "הצג חיפוש"; // עדכן את כפתור החיפוש ל"הצג חיפוש"
        } else {
          // אם העורך נסגר, הסתר את רשימת המתכונים
          recipesContainer.style.display = "none";
        }
      }
    
      function showSearchResults() {
  const searchWord = document.getElementById("search-word").value.toLowerCase();
  const transaction = db.transaction(["recipes"], "readonly");
  const store = transaction.objectStore("recipes");
  const request = store.getAll();

  request.onsuccess = (event) => {
    const recipes = event.target.result;
    const searchResults = document.getElementById("search-results");
    searchResults.innerHTML = "";

    if (!searchWord || searchWord === "הכל") {
      // הצג את כל המתכונים ללא כפתורים
      recipes.forEach((recipe, index) => {
        const recipeDiv = createRecipeElement(recipe, index, false); // false כדי להסתיר את הכפתורים
        searchResults.appendChild(recipeDiv);
      });
    } else {
      // חפש מתכונים שמכילים את מילת החיפוש
      const foundRecipes = recipes.filter((recipe) => {
        return (
          recipe.title.toLowerCase().includes(searchWord) ||
          recipe.ingredients.toLowerCase().includes(searchWord) ||
          recipe.instructions.toLowerCase().includes(searchWord)
        );
      });

      if (foundRecipes.length > 0) {
        // הצג את המתכונים שנמצאו ללא כפתורים
        foundRecipes.forEach((recipe, index) => {
          const recipeDiv = createRecipeElement(recipe, index, false); // false כדי להסתיר את הכפתורים
          searchResults.appendChild(recipeDiv);
        });
      } else {
        // אם לא נמצאו מתכונים, הצג הודעה
        searchResults.innerHTML =
          "<p>לא נמצאו מתכונים שמכילים את המילה המבוקשת.</p>";
      }
    }

    // הצג את אזור תוצאות החיפוש והסתר את רשימת המתכונים הרגילה
    searchResults.style.display = "block";
    const recipesContainer = document.getElementById("recipes");
    recipesContainer.style.display = "none";

    // עדכון טקסט הכפתור ל"הסתר חיפוש"
    const toggleBtn = document.getElementById("toggle-search-btn");
    if (toggleBtn) {
      toggleBtn.innerText = "הסתר חיפוש";
    }
  };

  request.onerror = (event) => {
    console.error("Error loading recipes:", event.target.error);
  };
}
    
      document
        .getElementById("search-word")
        .addEventListener("keypress", function (event) {
          if (event.key === "Enter") {
            event.preventDefault(); // מונע את ברירת המחדל של שליחת הטופס
            showSearchResults(); // מפעיל את פונקציית החיפוש
          }
        });
    
      function confirmDeleteAll() {
        if (
          confirm(
            "האם אתה בטוח שברצונך למחוק את כל המתכונים? פעולה זו אינה הפיכה."
          )
        ) {
          deleteAllRecipes();
        }
      }
    
      function deleteAllRecipes() {
        const transaction = db.transaction(["recipes"], "readwrite");
        const store = transaction.objectStore("recipes");
        const clearRequest = store.clear();
    
        clearRequest.onsuccess = () => {
          console.log("All recipes deleted successfully.");
          loadRecipes(); // טען מחדש את רשימת המתכונים (שעכשיו תהיה ריקה)
        };
    
        clearRequest.onerror = (event) => {
          console.error("Error deleting all recipes:", event.target.error);
        };
      }
    
      function searchCategory(category) {
  const transaction = db.transaction(["recipes"], "readonly");
  const store = transaction.objectStore("recipes");
  const request = store.getAll();

  request.onsuccess = (event) => {
    const recipes = event.target.result;
    const searchResults = document.getElementById("search-results");
    searchResults.innerHTML = "";

    // חפש מתכונים שבהם הקטגוריה תואמת
    const foundRecipes = recipes.filter((recipe) => {
      return recipe.category === category; // חפש רק לפי הקטגוריה
    });

    if (foundRecipes.length > 0) {
      // הצג את המתכונים שנמצאו ללא כפתורים
      foundRecipes.forEach((recipe, index) => {
        const recipeDiv = createRecipeElement(recipe, index, false); // false כדי להסתיר את הכפתורים
        searchResults.appendChild(recipeDiv);
      });
    } else {
      // אם לא נמצאו מתכונים, הצג הודעה
      searchResults.innerHTML = `<p>לא נמצאו מתכונים בקטגוריה: ${category}.</p>`;
    }

    // הצג את אזור תוצאות החיפוש והסתר את רשימת המתכונים הרגילה
    searchResults.style.display = "block";
    const recipesContainer = document.getElementById("recipes");
    recipesContainer.style.display = "none";

    // עדכון טקסט הכפתור ל"הסתר חיפוש"
    const toggleBtn = document.getElementById("toggle-search-btn");
    toggleBtn.innerText = "הסתר חיפוש";
  };

  request.onerror = (event) => {
    console.error("Error loading recipes:", event.target.error);
  };
}
    
      /**
       * הצג הודעה למשתמש (Toast Message)
       * @param {string} message - הטקסט שיוצג בהודעה
       * @param {boolean} isError - האם זו הודעת שגיאה (צבע אדום) או הודעת הצלחה (צבע ירוק)
       */
      function showToast(message, isError = false) {
        // יצירת אלמנט להודעה
        const toast = document.createElement("div");
        toast.style.position = "fixed";
        toast.style.bottom = "20px";
        toast.style.right = "20px";
        toast.style.padding = "10px 20px";
        toast.style.backgroundColor = isError ? "#ff4444" : "#4caf50"; // צבע רקע אדום לשגיאות, ירוק להצלחות
        toast.style.color = "white";
        toast.style.borderRadius = "5px";
        toast.style.zIndex = "1000";
        toast.style.transition = "opacity 0.5s";
        toast.innerText = message;
    
        // הוספת ההודעה לדף
        document.body.appendChild(toast);
    
        // הסרת ההודעה לאחר 3 שניות
        setTimeout(() => {
          toast.style.opacity = "0";
          setTimeout(() => {
            document.body.removeChild(toast);
          }, 500); // המתן עד שההודעה תיעלם לחלוטין
        }, 3000);
      }

function shareRecipe(index) {
  const transaction = db.transaction(["recipes"], "readonly");
  const store = transaction.objectStore("recipes");
  const request = store.getAll();

  request.onsuccess = (event) => {
    const recipes = event.target.result;
    const recipe = recipes[index];

    if (!recipe) {
      alert("מתכון לא נמצא.");
      return;
    }

    // יצירת תוכן לשיתוף (מיושר לימין עם מעבר שורה אחרי "מצרכים:" ו"הוראות הכנה:")
    const shareContent = {
      title: recipe.title, // כותרת המתכון
      text: `\u200F${recipe.title}\n\nכמות: ${recipe.quantity}\n\nמצרכים:\n${recipe.ingredients}\n\nהוראות הכנה:\n${recipe.instructions}`, // פרטי המתכון עם רווחים ומיושר לימין
    };

    // בדיקה אם Web Share API נתמך
    if (navigator.share) {
      navigator.share(shareContent)
        .then(() => console.log("שיתוף בוצע בהצלחה!"))
        .catch((error) => console.log("שגיאה בשיתוף:", error));
    } else {
      // אם Web Share API לא נתמך, נשתמש בקישורים מיוחדים
      const whatsappLink = `https://wa.me/?text=${encodeURIComponent(shareContent.text)}`;
      const telegramLink = `https://t.me/share/url?text=${encodeURIComponent(shareContent.text)}`;
      
      // פתיחת חלון עם אפשרויות שיתוף
      const shareWindow = window.open("", "שתף מתכון", "width=600,height=400");
      shareWindow.document.write(`
        <html dir="rtl">
          <head>
            <title>שתף מתכון</title>
            <style>
              body {
                font-family: Arial, sans-serif;
                padding: 20px;
                text-align: right;
              }
              button {
                display: block;
                margin: 10px 0;
                padding: 10px;
                background-color: #4caf50;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
              }
            </style>
          </head>
          <body>
            <h1>שתף מתכון</h1>
            <button onclick="window.open('${whatsappLink}', '_blank')">שתף בוואטסאפ</button>
            <button onclick="window.open('${telegramLink}', '_blank')">שתף בטלגרם</button>
            <button onclick="window.close()">סגור</button>
          </body>
        </html>
      `);
    }
  };

  request.onerror = (event) => {
    console.error("Error loading recipes:", event.target.error);
  };
}




        // תוספות עבור פונקציית סגירת הישום




// פונקציה לטיפול בלחיצה אחורה - ללא שינוי
let backButtonClicks = 0;
let backButtonTimer = null;

function handleBackButton() {
  backButtonClicks++;
  
  if (backButtonClicks === 1) {
    backButtonTimer = setTimeout(() => {
      window.location.reload();
      backButtonClicks = 0;
    }, 300);
  } else if (backButtonClicks === 2) {
    clearTimeout(backButtonTimer);
    backButtonClicks = 0;
    showExitConfirm();
  }
}

// פונקציה מעודכנת להצגת דיאלוג יציאה
function showExitConfirm() {
  const modal = document.createElement('div');
  modal.id = 'exit-modal';
  modal.style.position = 'fixed';
  modal.style.top = '0';
  modal.style.left = '0';
  modal.style.width = '100%';
  modal.style.height = '100%';
  modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
  modal.style.zIndex = '10000';
  modal.style.display = 'flex';
  modal.style.justifyContent = 'center';
  modal.style.alignItems = 'center';
  
  modal.innerHTML = `
    <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; max-width: 80%;">
      <h3 style="margin-bottom: 15px;">האם אתה בטוח שברצונך לצאת?</h3>
      <button id="confirm-exit" style="background: #ff4444; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin: 0 5px;">יציאה</button>
      <button id="cancel-exit" style="background: #4caf50; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin: 0 5px;">ביטול</button>
    </div>
  `;
  
  document.body.appendChild(modal);

  // מאזינים חדשים עם event delegation
  modal.querySelector('#confirm-exit').addEventListener('click', () => {
    // פתרון אמין יותר ליציאה
    if (window.history.length > 1) {
      window.history.go(-(window.history.length - 1)); // חוזרים לדף הראשון בהיסטוריה
    } else {
      window.location.href = 'https://www.google.com'; // פתרון גיבוי
    }
    document.body.removeChild(modal);
  });

  modal.querySelector('#cancel-exit').addEventListener('click', () => {
    document.body.removeChild(modal);
  });
}

// מאזין לאירועי הסטוריה - ללא שינוי
window.onpopstate = function(event) {
  handleBackButton();
  history.pushState(null, null, window.location.pathname);
};

// דחוף מצב היסטוריה - ללא שינוי
history.pushState(null, null, window.location.pathname);

    </script>
  </body>
</html>
